<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yqwl.dao.HousesNewMapper">
  <resultMap id="BaseResultMap" type="com.yqwl.pojo.HousesNew">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="BIGINT" property="id" />
    <result column="houes_number" jdbcType="VARCHAR" property="houes_number" />
    <result column="building_id" jdbcType="BIGINT" property="building_id" />
    <result column="work_name" jdbcType="VARCHAR" property="work_name" />
    <result column="house_picture" jdbcType="VARCHAR" property="house_picture" />
    <result column="office_space" jdbcType="INTEGER" property="office_space" />
    <result column="location_number" jdbcType="INTEGER" property="location_number" />
    <result column="house_type" jdbcType="VARCHAR" property="house_type" />
    <result column="location" jdbcType="INTEGER" property="location" />
    <result column="money" jdbcType="DECIMAL" property="money" />
    <result column="money_unit" jdbcType="INTEGER" property="money_unit" />
    <result column="rent_time" jdbcType="INTEGER" property="rent_time" />
    <result column="times" jdbcType="TIMESTAMP" property="times" />
    <result column="fitment" jdbcType="INTEGER" property="fitment" />
    <result column="types" jdbcType="INTEGER" property="types" />
    <result column="entering_broker_id" jdbcType="INTEGER" property="entering_broker_id" />
    <result column="home_name" jdbcType="VARCHAR" property="home_name" />
    <result column="home_number" jdbcType="INTEGER" property="home_number" />
    <result column="solid_broker_id" jdbcType="INTEGER" property="solid_broker_id" />
    <result column="maintain_broker_id" jdbcType="INTEGER" property="maintain_broker_id" />
    <result column="whether" jdbcType="INTEGER" property="whether" />
    <result column="door_id" jdbcType="BIGINT" property="door_id" />
    <result column="shop_id" jdbcType="BIGINT" property="shop_id" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    `id`, `houes_number`, `building_id`, `work_name`, `house_picture`, `office_space`, 
    `location_number`, `house_type`, `location`, `money`, `money_unit`, `rent_time`, 
    `times`, `fitment`, `types`, `entering_broker_id`, `home_name`, `home_number`, `solid_broker_id`, 
    `maintain_broker_id`, `whether`, `door_id`, `shop_id`
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from `t_houses_new`
    where `id` = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from `t_houses_new`
    where `id` = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.yqwl.pojo.HousesNew">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into `t_houses_new` (`houes_number`, `building_id`, `work_name`, 
      `house_picture`, `office_space`, `location_number`, 
      `house_type`, `location`, `money`, 
      `money_unit`, `rent_time`, `times`, 
      `fitment`, `types`, `entering_broker_id`, 
      `home_name`, `home_number`, `solid_broker_id`, 
      `maintain_broker_id`, `whether`, `door_id`, 
      `shop_id`)
    values (#{houes_number,jdbcType=VARCHAR}, #{building_id,jdbcType=BIGINT}, #{work_name,jdbcType=VARCHAR}, 
      #{house_picture,jdbcType=VARCHAR}, #{office_space,jdbcType=INTEGER}, #{location_number,jdbcType=INTEGER}, 
      #{house_type,jdbcType=VARCHAR}, #{location,jdbcType=INTEGER}, #{money,jdbcType=DECIMAL}, 
      #{money_unit,jdbcType=INTEGER}, #{rent_time,jdbcType=INTEGER}, #{times,jdbcType=TIMESTAMP}, 
      #{fitment,jdbcType=INTEGER}, #{types,jdbcType=INTEGER}, #{entering_broker_id,jdbcType=INTEGER}, 
      #{home_name,jdbcType=VARCHAR}, #{home_number,jdbcType=INTEGER}, #{solid_broker_id,jdbcType=INTEGER}, 
      #{maintain_broker_id,jdbcType=INTEGER}, #{whether,jdbcType=INTEGER}, #{door_id,jdbcType=BIGINT}, 
      #{shop_id,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.yqwl.pojo.HousesNew">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="id" order="AFTER" resultType="java.lang.Long">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into `t_houses_new`
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="houes_number != null">
        `houes_number`,
      </if>
      <if test="building_id != null">
        `building_id`,
      </if>
      <if test="work_name != null">
        `work_name`,
      </if>
      <if test="house_picture != null">
        `house_picture`,
      </if>
      <if test="office_space != null">
        `office_space`,
      </if>
      <if test="location_number != null">
        `location_number`,
      </if>
      <if test="house_type != null">
        `house_type`,
      </if>
      <if test="location != null">
        `location`,
      </if>
      <if test="money != null">
        `money`,
      </if>
      <if test="money_unit != null">
        `money_unit`,
      </if>
      <if test="rent_time != null">
        `rent_time`,
      </if>
      <if test="times != null">
        `times`,
      </if>
      <if test="fitment != null">
        `fitment`,
      </if>
      <if test="types != null">
        `types`,
      </if>
      <if test="entering_broker_id != null">
        `entering_broker_id`,
      </if>
      <if test="home_name != null">
        `home_name`,
      </if>
      <if test="home_number != null">
        `home_number`,
      </if>
      <if test="solid_broker_id != null">
        `solid_broker_id`,
      </if>
      <if test="maintain_broker_id != null">
        `maintain_broker_id`,
      </if>
      <if test="whether != null">
        `whether`,
      </if>
      <if test="door_id != null">
        `door_id`,
      </if>
      <if test="shop_id != null">
        `shop_id`,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="houes_number != null">
        #{houes_number,jdbcType=VARCHAR},
      </if>
      <if test="building_id != null">
        #{building_id,jdbcType=BIGINT},
      </if>
      <if test="work_name != null">
        #{work_name,jdbcType=VARCHAR},
      </if>
      <if test="house_picture != null">
        #{house_picture,jdbcType=VARCHAR},
      </if>
      <if test="office_space != null">
        #{office_space,jdbcType=INTEGER},
      </if>
      <if test="location_number != null">
        #{location_number,jdbcType=INTEGER},
      </if>
      <if test="house_type != null">
        #{house_type,jdbcType=VARCHAR},
      </if>
      <if test="location != null">
        #{location,jdbcType=INTEGER},
      </if>
      <if test="money != null">
        #{money,jdbcType=DECIMAL},
      </if>
      <if test="money_unit != null">
        #{money_unit,jdbcType=INTEGER},
      </if>
      <if test="rent_time != null">
        #{rent_time,jdbcType=INTEGER},
      </if>
      <if test="times != null">
        #{times,jdbcType=TIMESTAMP},
      </if>
      <if test="fitment != null">
        #{fitment,jdbcType=INTEGER},
      </if>
      <if test="types != null">
        #{types,jdbcType=INTEGER},
      </if>
      <if test="entering_broker_id != null">
        #{entering_broker_id,jdbcType=INTEGER},
      </if>
      <if test="home_name != null">
        #{home_name,jdbcType=VARCHAR},
      </if>
      <if test="home_number != null">
        #{home_number,jdbcType=INTEGER},
      </if>
      <if test="solid_broker_id != null">
        #{solid_broker_id,jdbcType=INTEGER},
      </if>
      <if test="maintain_broker_id != null">
        #{maintain_broker_id,jdbcType=INTEGER},
      </if>
      <if test="whether != null">
        #{whether,jdbcType=INTEGER},
      </if>
      <if test="door_id != null">
        #{door_id,jdbcType=BIGINT},
      </if>
      <if test="shop_id != null">
        #{shop_id,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.yqwl.pojo.HousesNew">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update `t_houses_new`
    <set>
      <if test="houes_number != null">
        `houes_number` = #{houes_number,jdbcType=VARCHAR},
      </if>
      <if test="building_id != null">
        `building_id` = #{building_id,jdbcType=BIGINT},
      </if>
      <if test="work_name != null">
        `work_name` = #{work_name,jdbcType=VARCHAR},
      </if>
      <if test="house_picture != null">
        `house_picture` = #{house_picture,jdbcType=VARCHAR},
      </if>
      <if test="office_space != null">
        `office_space` = #{office_space,jdbcType=INTEGER},
      </if>
      <if test="location_number != null">
        `location_number` = #{location_number,jdbcType=INTEGER},
      </if>
      <if test="house_type != null">
        `house_type` = #{house_type,jdbcType=VARCHAR},
      </if>
      <if test="location != null">
        `location` = #{location,jdbcType=INTEGER},
      </if>
      <if test="money != null">
        `money` = #{money,jdbcType=DECIMAL},
      </if>
      <if test="money_unit != null">
        `money_unit` = #{money_unit,jdbcType=INTEGER},
      </if>
      <if test="rent_time != null">
        `rent_time` = #{rent_time,jdbcType=INTEGER},
      </if>
      <if test="times != null">
        `times` = #{times,jdbcType=TIMESTAMP},
      </if>
      <if test="fitment != null">
        `fitment` = #{fitment,jdbcType=INTEGER},
      </if>
      <if test="types != null">
        `types` = #{types,jdbcType=INTEGER},
      </if>
      <if test="entering_broker_id != null">
        `entering_broker_id` = #{entering_broker_id,jdbcType=INTEGER},
      </if>
      <if test="home_name != null">
        `home_name` = #{home_name,jdbcType=VARCHAR},
      </if>
      <if test="home_number != null">
        `home_number` = #{home_number,jdbcType=INTEGER},
      </if>
      <if test="solid_broker_id != null">
        `solid_broker_id` = #{solid_broker_id,jdbcType=INTEGER},
      </if>
      <if test="maintain_broker_id != null">
        `maintain_broker_id` = #{maintain_broker_id,jdbcType=INTEGER},
      </if>
      <if test="whether != null">
        `whether` = #{whether,jdbcType=INTEGER},
      </if>
      <if test="door_id != null">
        `door_id` = #{door_id,jdbcType=BIGINT},
      </if>
      <if test="shop_id != null">
        `shop_id` = #{shop_id,jdbcType=BIGINT},
      </if>
    </set>
    where `id` = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.yqwl.pojo.HousesNew">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update `t_houses_new`
    set `houes_number` = #{houes_number,jdbcType=VARCHAR},
      `building_id` = #{building_id,jdbcType=BIGINT},
      `work_name` = #{work_name,jdbcType=VARCHAR},
      `house_picture` = #{house_picture,jdbcType=VARCHAR},
      `office_space` = #{office_space,jdbcType=INTEGER},
      `location_number` = #{location_number,jdbcType=INTEGER},
      `house_type` = #{house_type,jdbcType=VARCHAR},
      `location` = #{location,jdbcType=INTEGER},
      `money` = #{money,jdbcType=DECIMAL},
      `money_unit` = #{money_unit,jdbcType=INTEGER},
      `rent_time` = #{rent_time,jdbcType=INTEGER},
      `times` = #{times,jdbcType=TIMESTAMP},
      `fitment` = #{fitment,jdbcType=INTEGER},
      `types` = #{types,jdbcType=INTEGER},
      `entering_broker_id` = #{entering_broker_id,jdbcType=INTEGER},
      `home_name` = #{home_name,jdbcType=VARCHAR},
      `home_number` = #{home_number,jdbcType=INTEGER},
      `solid_broker_id` = #{solid_broker_id,jdbcType=INTEGER},
      `maintain_broker_id` = #{maintain_broker_id,jdbcType=INTEGER},
      `whether` = #{whether,jdbcType=INTEGER},
      `door_id` = #{door_id,jdbcType=BIGINT},
      `shop_id` = #{shop_id,jdbcType=BIGINT}
    where `id` = #{id,jdbcType=BIGINT}
  </update>
  <resultMap id="QuerySceneTypeVo" type="com.yqwl.Vo.HousesNewVo">
        <result column="building_id" property="building_id" />
        <result column="work_name" property="work_name" />
        <result column="office_space" property="office_space" />
        <result column="house_picture" property="house_picture" />
        <result column="location_number" property="location_number" />
        <result column="house_type" property="house_type" />
        <result column="location" property="location" />
        <result column="money" property="money" />
        <result column="money_unit" property="money_unit" />
        <result column="rent_time" property="rent_time" />
        <result column="fitment" property="fitment" />
        <result column="times" property="times" />
        <result column="maintain_broker_id" property="maintain_broker_id" />
        <result column="mansion_name" property="mansion_name" />
        <result column="mansion_picture" property="mansion_picture" />
        <result column="region_sh_id" property="region_sh_id" />
        <result column="region_shname" property="region_shname" />
        <result column="region_city_id" property="region_city_id" />
        <result column="region_cityname" property="region_cityname" />
        <result column="region_id" property="region_id" />
        <result column="region_name" property="region_name" />
        <result column="district" property="district" />
        <result column="floor" property="floor" />
        <result column="intro" property="intro" />
        <result column="circum" property="circum" />
        <result column="longitude" property="longitude" />
        <result column="latitude" property="latitude" />
    </resultMap>

   <select id="selectByFindID" parameterType="java.lang.Long" resultMap="QuerySceneTypeVo">
		SELECT
		hn.building_id as building_id,
		hn.work_name as work_name,
		hn.office_space as office_space,
		hn.location_number as location_number,
		hn.house_type as house_type,
		hn.location as location,
		hn.money as money,
		hn.money_unit as money_unit,
		hn.rent_time as rent_time,
		hn.fitment as fitment,
		hn.times as times,
		hn.maintain_broker_id as maintain_broker_id,
		b.mansion_name as mansion_name,
		b.mansion_picture as mansion_picture,
		b.region_sh_id as region_sh_id,
		b.region_shname as region_shname,
		b.region_city_id as region_city_id,
		b.region_cityname as region_cityname,
		b.region_id as region_id,
		b.region_name as region_name,
		b.district as district,
		b.floor as floor,
		b.intro as intro,
		b.circum as circum,
		b.longitude as longitude,
		b.latitude as latitude
		FROM
		t_houses_new hn,t_building b
		WHERE
		b.id=hn.building_id
		AND
		hn.id=#{id}
	</select>
	<select id="selectLike" parameterType="com.yqwl.Vo.HousesNewVo" resultMap="QuerySceneTypeVo">
		SELECT
		hn.id as id,
		hn.work_name as work_name,
		hn.house_picture as house_picture,
		hn.money as money,
		hn.money_unit as money_unit,
		b.region_sh_id as region_sh_id,
		b.region_shname as region_shname,
		b.region_city_id as region_city_id,
		b.region_cityname as region_cityname,
		b.region_id as region_id,
		b.region_name as region_name
		FROM
		t_houses_new hn,t_building b
		WHERE
		b.id=hn.building_id
		and b.region_city_id=#{region_city_id}
		and hn.whether = 1
		ORDER BY
		hn.times DESC
		LIMIT #{page},#{limit}
	</select>
  <select id="listHousesNewByCondition" resultMap="BaseResultMap">
  	SELECT 
  		 h.*
	FROM
		t_building AS b
	JOIN t_houses_new AS h ON b.id = h.building_id
	WHERE
		b.region_city_id = #{cityId}
	AND (ISNULL(#{regionId})
	OR b.region_id = #{regionId})
	AND (
		(ISNULL(#{startSpace})
		OR h.office_space <![CDATA[>=]]> #{startSpace})
		AND (ISNULL(#{endSpace})
		OR h.office_space <![CDATA[<=]]> #{endSpace})
	)
	<if test="startMoney !=null or endMoney != null">
	AND (
		<if test="startMoney != null">
		h.money <![CDATA[>=]]> #{startMoney}
		</if>
		<if test="startMoney != null and endMoney != null">
		AND h.money <![CDATA[<=]]> #{endMoney}
		</if>
		<if test="endMoney != null and startMoney == null">
		h.money <![CDATA[<=]]> #{endMoney}
		</if>
	) 
	</if>
	AND ((ISNULL(#{fitment})) OR h.fitment = #{fitment})
	AND ((ISNULL(#{brokerId})) OR h.entering_broker_id = #{brokerId})
	AND (((ISNULL(#{phoneOrName})) OR h.home_name = #{phoneOrName})
	OR ((ISNULL(#{phoneOrName})) OR h.home_number = #{phoneOrName}))
	AND ((ISNULL(#{buildingId})) OR h.building_id = #{buildingId})
	AND h.whether = 1
  </select>
	
  <select id="listHousesNewByBuildingId" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from `t_houses_new`
    where `building_id` = #{buildingId}
    and `whether` = 1
    order by `money` ASC
  </select>
  <!-- 查询该商厦下的房源信息 -->
  <select id="selectHousesNew" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from `t_houses_new`
    where `building_id` = #{buildingId}
    order by `money` ASC
  </select>
  
  <select id="ListBackHousesNew" resultMap="BaseResultMap">
  	SELECT 
  		 h.*
	FROM
		t_building AS b
	JOIN t_houses_new AS h ON b.id = h.building_id
	WHERE
		b.region_city_id = #{cityId}
	AND (ISNULL(#{regionId})
	OR b.region_id = #{regionId})
	AND (
		(ISNULL(#{startSpace})
		OR h.office_space <![CDATA[>=]]> #{startSpace})
		AND (ISNULL(#{endSpace})
		OR h.office_space <![CDATA[<=]]> #{endSpace})
	)
	<if test="startMoney !=null or endMoney != null">
	AND (
		<if test="startMoney != null">
		h.money <![CDATA[>=]]> #{startMoney}
		</if>
		<if test="startMoney != null and endMoney != null">
		AND h.money <![CDATA[<=]]> #{endMoney}
		</if>
		<if test="endMoney != null and startMoney == null">
		h.money <![CDATA[<=]]> #{endMoney}
		</if>
	) 
	</if>
	AND ((ISNULL(#{fitment})) OR h.fitment = #{fitment})
	AND h.whether = 1
	AND h.shop_id = #{shopId}
  </select>
  <select id="listByShopId" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from `t_houses_new`
    where `shop_id` = #{id}
  </select>
  
</mapper>