(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f9e5570"],{"1a44":function(t,e,a){"use strict";var i=a("dc10"),r=a.n(i);r.a},3846:function(t,e,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},5866:function(t,e,a){"use strict";a.r(e);var i,r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bigbox"},[a("el-breadcrumb",{staticClass:"navsbox",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("楼盘管理")]),a("el-breadcrumb-item",[t._v("所有楼盘")]),a("el-breadcrumb-item",[t._v("添加楼盘")])],1),a("div",{staticClass:"formbox"},[a("el-form",{staticClass:"demo-ruleForm flex",attrs:{rules:t.rules2,"label-width":"120px"}},[a("el-form-item",{staticClass:"formlist",attrs:{label:"楼盘名称",prop:"name"}},[a("el-input",{model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"楼盘地址"}},[a("el-cascader",{attrs:{size:"large",options:t.options},on:{change:t.addressChange,blur:t.mapClass},model:{value:t.selectedOptions,callback:function(e){t.selectedOptions=e},expression:"selectedOptions"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"详细地址",prop:"map"}},[a("el-input",{on:{blur:t.mapClass},model:{value:t.ruleForm.map,callback:function(e){t.$set(t.ruleForm,"map",e)},expression:"ruleForm.map"}})],1),a("el-form-item",{staticClass:"formlist",staticStyle:{"text-align":"left"},attrs:{label:"地址经纬度",prop:"maps"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.mapbox()}}},[t._v("地图")])],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"楼盘面积",prop:"ms"}},[a("el-input",{model:{value:t.ruleForm.m,callback:function(e){t.$set(t.ruleForm,"m",e)},expression:"ruleForm.m"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"写字楼栋数",prop:"Buildingnums"}},[a("el-input",{model:{value:t.ruleForm.Buildingnum,callback:function(e){t.$set(t.ruleForm,"Buildingnum",e)},expression:"ruleForm.Buildingnum"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"交通情况描述",prop:"Traffic "}},[a("el-input",{model:{value:t.ruleForm.Traffic,callback:function(e){t.$set(t.ruleForm,"Traffic",e)},expression:"ruleForm.Traffic "}})],1),a("el-form-item",{attrs:{label:"商厦建成时间",prop:"datasa"}},[a("el-input",{model:{value:t.datas,callback:function(e){t.datas=e},expression:"datas "}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"物业费",prop:"wylcs"}},[a("el-input",{model:{value:t.ruleForm.lc,callback:function(e){t.$set(t.ruleForm,"lc",e)},expression:"ruleForm.lc"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"停车费",prop:"parkingmoneys"}},[a("el-input",{model:{value:t.ruleForm.parkingmoney,callback:function(e){t.$set(t.ruleForm,"parkingmoney",e)},expression:"ruleForm.parkingmoney"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"空调费",prop:"airmoneys"}},[a("el-input",{model:{value:t.ruleForm.airmoney,callback:function(e){t.$set(t.ruleForm,"airmoney",e)},expression:"ruleForm.airmoney"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"商厦简介",prop:"introduces"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.introduce,callback:function(e){t.$set(t.ruleForm,"introduce",e)},expression:"ruleForm.introduce"}})],1),a("el-form-item",{staticClass:"formlist",attrs:{label:"周边介绍"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.ruleForm.periphery,callback:function(e){t.$set(t.ruleForm,"periphery",e)},expression:"ruleForm.periphery"}})],1),a("el-form-item",{attrs:{label:"商厦图片"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:this.$store.state.actionUrl,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"file-list":t.fileList,limit:t.int,"on-success":t.upsuccessa,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("*只能上传一张jpg/png文件")])],1),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.shows,expression:"!shows"}],staticClass:"imgspan"},[a("img",{attrs:{src:t.imgArrlista,alt:""}}),a("span",[t._v("替换前图片")])])],1),a("el-form-item",{attrs:{label:"商厦详情图"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:this.$store.state.actionUrl,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"file-list":t.fileList,"on-success":t.upsuccess,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.shows,expression:"!shows"}],staticClass:"imgbox"},t._l(t.pictureslist,function(e,i){return a("span",{staticClass:"imgspan"},[a("i",{staticClass:"el-icon-delete",on:{click:function(a){return t.dele(e.id)}}}),a("img",{attrs:{src:e.photo,alt:""}})])}),0)],1)],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.shows,expression:"shows"}],attrs:{type:"primary"},on:{click:function(e){return t.updataform()}}},[t._v("提交")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.shows,expression:"!shows"}],attrs:{type:"primary"},on:{click:function(e){return t.xgform()}}},[t._v("修改")])],1),a("el-dialog",{attrs:{visible:t.dialogFormVisibles},on:{"update:visible":function(e){t.dialogFormVisibles=e}}},[a("div",{staticClass:"itemss"},[a("span",[t._v("当前经度: ")]),a("el-input",{staticClass:"inps",attrs:{id:"jing"},model:{value:t.jing,callback:function(e){t.jing=e},expression:"jing"}})],1),a("div",{staticClass:"itemss"},[a("span",[t._v("当前纬度:")]),a("el-input",{staticClass:"inps",attrs:{type:"text",id:"wei"},model:{value:t.wei,callback:function(e){t.wei=e},expression:"wei"}})],1),a("div",{attrs:{id:"container"}}),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogFormVisibles=!1}}},[t._v("确 定")])],1)],1)},s=[],o=(a("6b54"),a("7f7f"),a("ef6c")),n=0,l=0,u={name:"addhousList",data:function(){var t=this,e=function(e,a,i){return t.ruleForm.Buildingnum?/^[1-9]\d*$|^0$/.test(t.ruleForm.Buildingnum)?void i():i(new Error("请填入数字")):i(new Error("写字楼栋数不能为空"))},a=function(e,a,i){return t.ruleForm.m?/^[1-9]\d*$|^0$/.test(t.ruleForm.m)?void i():i(new Error("请填入数字")):i(new Error("楼盘面积不能为空"))},i=function(e,a,i){return t.ruleForm.lc?/^[1-9]\d*$|^0$/.test(t.ruleForm.lc)?void i():i(new Error("请填入数字")):i(new Error("物业费不能为空"))},r=function(e,a,i){return t.ruleForm.parkingmoney?/^[1-9]\d*$|^0$/.test(t.ruleForm.parkingmoney)?void i():i(new Error("请填入数字")):i(new Error("停车费不能为空"))},s=function(e,a,i){return t.ruleForm.airmoney?/^[1-9]\d*$|^0$/.test(t.ruleForm.airmoney)?void i():i(new Error("请填入数字")):i(new Error("空调费不能为空"))};return{jing:null,wei:null,dialogFormVisibles:!1,selectedOptionsnamme:[],queryslng:n,queryslat:l,maparr:[],mapidarr:[],shows:!1,datas:"",cascaders:[],valuesj:"",valuezt:"",int:1,valuekcjjr:"",valuewhjjr:"",imgArrlista:null,buildingId:null,fileList:[],valuezdp:"",valuess:"",valuezx:"",values:null,value:null,options:o["regionData"],selectedOptions:[],dialogFormVisible:!1,ruleForm:{parkingmoney:"",airmoney:"",introduce:"",periphery:"",lc:"",name:"",map:"",m:"",Buildingnum:"",Traffic:"",Buildingyear:"",wymoney:"",wyyear:"",seleqws:"1",years:"1"},mapboxLocation:{lng:null,lat:null},rules2:{Buildingnums:[{validator:e,trigger:"blur"}],ms:[{validator:a,trigger:"blur"}],wylcs:[{validator:i,trigger:"blur"}],parkingmoneys:[{validator:r,trigger:"blur"}],airmoneys:[{validator:s,trigger:"blur"}]},formLabelWidth:"120px",optionmoneydp:[],optionsids:[],imgArrlist:[],optionmonewhjjr:[],optionmonekcjjr:[],pictureslist:[],mapssG:!0}},methods:{mapbox:function(){var t=this;this.dialogFormVisibles=!0,this.$axios("http://api.map.baidu.com/geocoder/v2/?",{params:{address:this.maparr[0]+this.maparr[1]+this.maparr[2]+this.ruleForm.map,output:"json",ak:"pdte5B83N8xwZnARmKqMZiF7Cu8b15YX"}}).then(function(e){t.$nextTick(function(){var e=document.getElementById("jing"),a=document.getElementById("wei");e.value=t.mapboxLocation.lng,a.value=t.mapboxLocation.lat;var r=new BMap.Map("container");if(null!=t.mapboxLocation.lng){var s=new BMap.Point(t.mapboxLocation.lng,t.mapboxLocation.lat),o=new BMap.Point(t.mapboxLocation.lng,t.mapboxLocation.lat),u=new window.BMap.Marker(o,s);r.removeOverlay(i),r.addOverlay(u),i=u}else s=new BMap.Point(116.403039,39.917344);r.centerAndZoom(s,18),r.enableScrollWheelZoom(),r.addEventListener("click",function(t){e.value=t.point.lng,n=t.point.lng,a.value=t.point.lat,l=t.point.lat});var m=new BMap.Geolocation;m.getCurrentPosition(function(t){})})})},dele:function(t){var e=this;this.$axios.post("photo/deleteloading.action",{id:t}).then(function(t){console.log(t),e.gethouses()}).catch(function(t){console.log(t)})},xgform:function(){var t=this;""==this.mapidarr&&(this.mapidarr.push(this.selectedOptions[0]),this.mapidarr.push(this.selectedOptions[1]),this.mapidarr.push(this.selectedOptions[2]),this.maparr.push(this.selectedOptionsnamme[0]),this.maparr.push(this.selectedOptionsnamme[1]),this.maparr.push(this.selectedOptionsnamme[2]));for(var e=0;e<this.pictureslist.length;e++)this.imgArrlist.push(this.pictureslist[e].photo);this.$axios.post("building/updateBy.action",{id:this.$route.query.id,mansion_name:this.ruleForm.name,region_sh_id:this.mapidarr[2],region_shname:this.maparr[2],region_city_id:this.mapidarr[1],region_cityname:this.maparr[1],region_id:this.mapidarr[0],region_name:this.maparr[0],district:this.ruleForm.map,proportion:this.ruleForm.m,floor:this.ruleForm.Buildingnum,traffic_condition:this.ruleForm.Traffic,data:this.datas,property_fee:this.ruleForm.lc,parking_fee:this.ruleForm.parkingmoney,conditioners_fee:this.ruleForm.airmoney,intro:this.ruleForm.introduce,circum:this.ruleForm.periphery,broker_id:window.sessionStorage.getItem("userId"),longitude:n,latitude:l,mansion_picture:this.imgArrlista,picture:this.imgArrlist}).then(function(e){0==e.data.code&&(t.$message({message:"修改楼盘成功",type:"success"}),setTimeout(function(){t.$router.push({path:"/housingResources/houseList"})},1e3))}).catch(function(t){console.log(t)})},updataform:function(){var t=this;null==this.imgArrlista?this.$notify.error({title:"错误",message:"请上传首页展示图"}):this.$axios.post("building/insertSelective.action",{mansion_name:this.ruleForm.name,region_sh_id:this.mapidarr[2],region_shname:this.maparr[2],region_city_id:this.mapidarr[1],region_cityname:this.maparr[1],region_id:this.mapidarr[0],region_name:this.maparr[0],district:this.ruleForm.map,proportion:this.ruleForm.m,floor:this.ruleForm.Buildingnum,traffic_condition:this.ruleForm.Traffic,date:this.datas.getTime(),property_fee:this.ruleForm.lc,parking_fee:this.ruleForm.parkingmoney,conditioners_fee:this.ruleForm.airmoney,intro:this.ruleForm.introduce,circum:this.ruleForm.periphery,broker_id:window.sessionStorage.getItem("userId"),longitude:n,latitude:l,mansion_picture:this.imgArrlista,picture:this.imgArrlist}).then(function(e){0==e.data.code&&(t.$message({message:"楼盘增加成功",type:"success"}),setTimeout(function(){t.$router.push({path:"/housingResources/houseList"})},1e3))}).catch(function(t){console.log(t)})},gethouses:function(){var t=this;if(void 0==this.$route.query.id)return!1;this.$axios.post("building/selectByPrimaryKey.action",{id:this.$route.query.id}).then(function(e){t.mapboxLocation.lng=e.data.data.data.longitude,t.mapboxLocation.lat=e.data.data.data.latitude,t.ruleForm.name=e.data.data.data.mansion_name,t.ruleForm.map=e.data.data.data.district,t.ruleForm.m=e.data.data.data.proportion,t.ruleForm.Buildingnum=e.data.data.data.floor,t.ruleForm.Traffic=e.data.data.data.traffic_condition,t.datas=e.data.data.data.activate_time,t.ruleForm.lc=e.data.data.data.parking_fee,t.ruleForm.parkingmoney=e.data.data.data.parking_fee,t.ruleForm.airmoney=e.data.data.data.conditioners_fee,t.ruleForm.introduce=e.data.data.data.intro,t.ruleForm.periphery=e.data.data.data.circum,t.pictureslist=e.data.data.photos,t.imgArrlista=e.data.data.data.mansion_picture,t.queryslng=e.data.data.data.longitude,t.queryslat=e.data.data.data.latitude,t.selectedOptions.push(e.data.data.data.region_id.toString()),t.selectedOptions.push(e.data.data.data.region_city_id.toString()),t.selectedOptions.push(e.data.data.data.region_sh_id.toString())})},upsuccessa:function(t,e,a){this.imgArrlista=a[0].response.data},upsuccess:function(t,e,a){this.imgArrlist=[];for(var i=0;i<a.length;i++)this.imgArrlist.push(a[i].response.data)},getss:function(t){this.buildingId=t,this.handleItemChanges(t)},getlistAllByCity:function(t){var e=this;this.$axios.post("building/listAllByCityId.action",{cityId:this.$route.query.cityid}).then(function(t){for(var a=0;a<t.data.data.length;a++){var i={};i.label=t.data.data[a].mansion_name,i.value=t.data.data[a].id,i.cities=[],e.optionmoneyss.push(i)}}).catch(function(t){console.log(t)})},getdp:function(){var t=this;this.$axios.post("backShop/listAll.action",{}).then(function(e){for(var a=0;a<e.data.data.length;a++){var i={};i.label=e.data.data[a].name,i.value=e.data.data[a].id,i.cities=[],t.optionmoneydp.push(i)}}).catch(function(t){console.log(t)})},submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(t,e){for(var a=0;a<this.imgArrlist.length;a++)this.imgArrlist[a]==t.response.data[0]&&this.imgArrlist.splice(a,1)},handlePreview:function(t){},seleqw:function(){},addressChange:function(t){this.mapidarr=t,this.maparr=[],this.maparr.push(o["CodeToText"][t[2]]),this.maparr.push(o["CodeToText"][t[1]]),this.maparr.push(o["CodeToText"][t[0]])},mapClass:function(t){var e=this;this.$axios("http://api.map.baidu.com/geocoder/v2/?",{params:{address:this.maparr[0]+this.maparr[1]+this.maparr[2]+this.ruleForm.map,output:"json",ak:"pdte5B83N8xwZnARmKqMZiF7Cu8b15YX"}}).then(function(t){e.mapboxLocation=t.data.result.location})},onSubmit:function(){},handleItemChange:function(t){var e=this;this.$axios.post("BackHousesNew/getPlotDoorByConditions.action",{BuildId:t[0]}).then(function(a){for(var i=0;i<e.optionsids.length;i++)if(e.optionsids[i].value==t[0]){e.optionsids[i].cities=[];for(var r=0;r<a.data.data.length;r++){var s={};s.label=a.data.data[r].door_num,s.value=a.data.data[r].id,1==a.data.data[r].status&&(s.disabled=!0),2==a.data.data[r].status&&(s.disabled=!0),e.optionsids[i].cities.push(s)}}}).catch(function(t){console.log(t)})},handleItemChanges:function(t){var e=this;""==t?alert("请选择商厦"):this.$axios.post("BackHousesNew/getPlotBuildByConditions.action",{BuildingId:t}).then(function(t){e.optionsids=[];for(var a=0;a<t.data.data.length;a++){var i={};i.label=t.data.data[a].name,i.value=t.data.data[a].id,i.cities=[],e.optionsids.push(i)}}).catch(function(t){console.log(t)})}},mounted:function(){window.sessionStorage.setItem("pathids",this.$route.fullPath),void 0==this.$route.query.id&&(this.shows=!0),void 0!=this.$route.query.id&&this.gethouses()}},m=u,c=(a("1a44"),a("2877")),d=Object(c["a"])(m,r,s,!1,null,"1a0b2565",null);e["default"]=d.exports},"6b54":function(t,e,a){"use strict";a("3846");var i=a("cb7c"),r=a("0bfb"),s=a("9e1e"),o="toString",n=/./[o],l=function(t){a("2aba")(RegExp.prototype,o,t,!0)};a("79e5")(function(){return"/a/b"!=n.call({source:"a",flags:"b"})})?l(function(){var t=i(this);return"/".concat(t.source,"/","flags"in t?t.flags:!s&&t instanceof RegExp?r.call(t):void 0)}):n.name!=o&&l(function(){return n.call(this)})},dc10:function(t,e,a){}}]);